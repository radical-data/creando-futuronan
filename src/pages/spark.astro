---
import ProgramLayout from "../layouts/ProgramLayout.astro";
import { getCollection } from "astro:content";
import { normaliseLocale, useTranslations } from "../i18n/utils";
import type { Lang } from "../i18n/ui";

const lang: Lang = normaliseLocale(Astro.currentLocale);
const t = useTranslations(lang);

function entryMatchesLocale(entryId: string, lang: Lang) {
  return entryId.startsWith(`${lang}/`);
}

// Load programme page content from collection
const programmePages = await getCollection("programme-pages");
const sparkPage = programmePages
  .find((page) => entryMatchesLocale(page.id, lang) && page.data.slug === "spark");

if (!sparkPage) {
  throw new Error(`Spark programme page not found for locale: ${lang}`);
}

const pageData = sparkPage.data;
---

<ProgramLayout
  title="Creando Spark — Creando Futuronan"
  description="A space for the restless ones. Where code, art, and AI collide."
  headline={pageData.headline}
  sub={pageData.sub}
  ageRange="12–18"
  ctas={[
    { label: t("programme.joinSpark"), href: "https://wa.me/2975689420" },
    { label: t("programme.readFaqs"), href: "#faq" },
  ]}
  programColor="var(--color-spark)"
  streamClass="stream-spark"
  muxPlaybackId="YLfcW2F42va7BITgERvMsUZr02DQOhin8qDse34WQAX00"
  aboutContent={pageData.aboutContent}
  schedule={pageData.schedule}
  methodologies={pageData.methodologies}
  team={pageData.team}
  location={pageData.location}
  language={pageData.language}
  applicationInfo={pageData.applicationInfo}
  faqs={pageData.faqs}
/>
