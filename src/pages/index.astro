---
import SiteLayout from "../layouts/Layout.astro";
import Hero from "../components/home/Hero.astro";
import Programmes from "../components/home/Programmes.astro";
import Partners from "../components/home/Partners.astro";
import ClosingCTA from "../components/home/ClosingCTA.astro";
import WhatsHappening from "../components/home/WhatsHappening.astro";
import heroImage from "../assets/hero.png";

import { getCollection } from "astro:content";

const programmes = (await getCollection("programmes")).map((p) => p.data);
const partnerCards = (await getCollection("partners")).map((p) => p.data);
const events = (await getCollection("events"))
  .map((e) => ({
    ...e.data,
    dateISO: e.data.dateISO.toISOString(),
  }))
  .sort(
    (a, b) => new Date(a.dateISO).getTime() - new Date(b.dateISO).getTime()
  );
const openCalls = (await getCollection("open-calls")).map((o) => o.data);

const headline = "Building futures from here, not elsewhere.";
const sub =
  "Creando Futuronan is a practical school for design and digital culture in Aruba. We equip young people and artists with the tools to imagine, build, and sustain futures rooted in Caribbean realities.";
---

<SiteLayout title="Creando Futuronan">
  <Hero
    headline={headline}
    sub={sub}
    ctas={[
      { label: "Join Creando Spark (12–18)", href: "/spark" },
      { label: "Apply to Creando Sustain (18–28)", href: "/sustain" },
    ]}
    image={heroImage}
  />

  <!-- Programmes -->
  <Programmes cards={programmes} />

  <!-- What’s happening now (Open Call or Events) -->
  <WhatsHappening openCall={openCalls} events={events} />

  <!-- Partners -->
  <Partners items={partnerCards} />

  <!-- Closing CTA -->
  <ClosingCTA />
</SiteLayout>
